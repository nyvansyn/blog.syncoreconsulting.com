!function($){"use strict";$(window).on("elementor:init",function(){var a=elementor.modules.controls.BaseData.extend({isTitlesReceived:!1,addControlSpinner:function(){this.ui.select.prop("disabled",!0),this.$el.find(".elementor-control-title").after('<span class="elementor-control-spinner">&nbsp;<i class="eicon-spinner eicon-animation-spin"></i>&nbsp;</span>')},prepareArgs:function(){var b=this,a=b.model.get("query_args");return _.isObject(a)||(a={}),a.widget_props&&_.isObject(a.widget_props)&&_.each(a.widget_props,function(c,d){a[d]=b.container.settings.get(c)}),a},getQueryData:function(){var a=$.extend({},this.prepareArgs());return delete a.widget_props,a},getValueTitles:function(){var b=this,a=this.getControlValue();if(a){_.isArray(a)||(a=[a]);var c={action:sky_dynamic_select.action,security:sky_dynamic_select.nonce,ids:a},d=$.extend({},c,b.getQueryData());$.ajax({url:ajaxurl,type:"POST",data:d,before:b.addControlSpinner(),success:function(a){if(b.isTitlesReceived=!0,a.success){var c={};_.each(a.data,function(a){c[a.id]=a.text}),b.model.set("options",c),b.ui.select&&b.ui.select.data("select2")&&b.render()}else console.log("server errors:",a.data)}})}},onReady:function(){var a=this;this.ui.select.select2({minimumInputLength:a.model.get("minlen")?a.model.get("minlen"):2,placeholder:a.model.get("placeholder")?a.model.get("placeholder"):"Type & Search",allowClear:!0,ajax:{url:ajaxurl,dataType:"json",method:"post",delay:300,data:function(b){var c={action:sky_dynamic_select.action,security:sky_dynamic_select.nonce,search_text:b.term};return $.extend({},c,a.getQueryData())},processResults:function(a){return a.success&&a.data?{results:a.data}:{results:[{id:-1,text:"Data Not Found!",disabled:!0}]}},cache:!0}}),this.isTitlesReceived||this.getValueTitles()},onBeforeDestroy:function(){this.ui.select.data("select2")&&this.ui.select.select2("destroy"),this.$el.remove()}});elementor.addControlView("sky-dynamic-select",a)})}(jQuery)
